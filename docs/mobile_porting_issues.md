# スマホ対応（モバイル化）に関する課題整理

現在の Electron アプリケーション (`Talklate4u`) をスマートフォン (iOS/Android) 対応させるための課題と実現可能性についてまとめました。

## 1. 結論：直接の移植は不可

**Electron アプリはスマホでは動作しません。**
Electron は PC (Windows/Mac/Linux) 専用のフレームワークであり、スマートフォン向けには別の技術スタックへの移行または再構築が必要です。

アプローチとしては以下の2つが考えられます：

1. **ハイブリッドアプリ化 (Capacitor/Cordova)**: 現在の React (Web) コードを再利用し、ネイティブ機能を追加する。
2. **ネイティブアプリ化 (React Native/Flutter/Swift/Kotlin)**: UI も含めてモバイル専用に作り直す。

## 2. 技術的課題 (Technical Challenges)

### A. アーキテクチャの非互換性

| 項目                 | 現状 (Electron)        | モバイル (iOS/Android)         | 課題                                                                |
| :------------------- | :--------------------- | :----------------------------- | :------------------------------------------------------------------ |
| **ランタイム**       | Node.js + Chromium     | Webview または Native          | Node.js API (`fs`, `child_process`) が使えない。                    |
| **プロセス管理**     | Main/Renderer プロセス | シングルスレッド (JS) + Native | `ipcMain` での通信設計を Plugin 経由などに書き換える必要あり。      |
| **バックグラウンド** | Node.js で処理継続可能 | OSによる厳しい制限             | アプリがバックグラウンドに回った際の音声認識継続が困難 (特に iOS)。 |

### B. 依存ライブラリの壁 (Native Dependencies)

最大の障壁は、PC 向けの**ネイティブバイナリ**に依存している機能です。

1.  **Whisper (音声認識)**
    - **現状**: `whisper-server.exe` (Windows実行ファイル) を `WhisperManager` から起動して通信。
    - **モバイル**: `.exe` は動作しません。
    - **対策**:
      - `whisper.cpp` の iOS/Android バインディングを使用する (例: `whisper.rn` など)。
      - CoreML (iOS) / TFLite (Android) モデルに変換してオンデバイス実行する。
      - クラウド API (OpenAI/Groq) 利用に切り替える (ローカル実行のプライバシー/オフライン要件とトレードオフ)。

2.  **ONNX Runtime / VAD (音声区間検出)**
    - **現状**: `onnxruntime-web` / `onnxruntime-node`
    - **モバイル**: WebGL/WASM バックエンドで動作する可能性があるが、パフォーマンスが出ない場合がある。`onnxruntime-react-native` のようなネイティブブリッジが必要になる可能性が高い。

3.  **OverlayServer (OBS連携)**
    - **現状**: ローカルサーバー (Socket.IO) を立てて OBS に表示。
    - **モバイル**: スマホで「OBSへのオーバーレイ」は一般的ではない（スマホ自体が配信端末になる場合を除く）。用途の再定義が必要。

### C. UI/UX の適応

- **画面サイズ**: 現在の `width: 1000px` 前提のレイアウトを、モバイルの縦長画面 (レスポンシブ) に完全に適応させる必要がある。
- **操作性**: ホバー (Hover) 効果が使えないため、タッチ操作前提の UI に変更が必要。
- **設定画面**: PC 向けの詳細な設定画面はスマホでは使いづらいため、簡略化が必要。

## 3. 実現へのロードマップ案

もしスマホ対応を進める場合、以下のステップが必要になります。

1.  **技術選定**: React Native (Expo) または Capacitor の採用を決定。
    - _React Native 推奨_: 音声処理などのネイティブ機能へのアクセスが強力なため。
2.  **コア機能の分離**: `src/main.ts` にあるロジック (翻訳、設定管理) を、Electron 依存から切り離して純粋な TS モジュール/フックにする。
3.  **音声エンジンの置換**: `whisper-server` の代替として、モバイル用ライブラリ (`react-native-whisper` 等) の検証と実装。
4.  **UI のレスポンシブ化**: Tailwind CSS を活用し、モバイルビューを作成。

## まとめ

「Webサイトとして表示する」だけなら比較的容易ですが、**「ローカルで Whisper を動かしてリアルタイム翻訳する」** というコア機能をスマホで実現するには、アプリの基盤を大幅に作り直す（または別プロジェクトとして立ち上げる）レベルの工数が必要です。
